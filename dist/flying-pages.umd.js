!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e||self).flyingPages={})}(this,function(e){function t(){return t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},t.apply(this,arguments)}var n=new Set,o=function(e,t,o){n.has(e)||(n.add(e),document.querySelector("a[href='"+e+"']").style.color="red",t(function(){return function(e){return new Promise(function(t,n){var o=document.createElement("link");o.rel="prefetch",o.as="document",o.href=e,o.onload=t,o.onerror=n,document.head.appendChild(o)})}(e).then(o).catch(o)}))},r=window.IntersectionObserver&&"isIntersecting"in IntersectionObserverEntry.prototype,i=navigator.connection&&(navigator.connection.saveData||(navigator.connection.effectiveType||"").includes("2g")),a=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e.listen=function(e){if(!i&&r&&(n=document.createElement("link")).relList&&n.relList.supports&&n.relList.supports("prefetch")){var n;e=t({},{throttle:3,desktopPreloadMethod:"nearby-mouse",mobilePreloadMethod:"all-in-viewport",mouseProximity:100,excludeKeywords:[]},e);var c,s,f=new Set,l=function(e){e=e||1;var t=[],n=0;function o(){n<e&&t.length>0&&(t.shift()(),n++)}return[function(e){t.push(e)>1||o()},function(){n--,o()}]}(e.throttle),u=l[0],d=l[1],h=a?e.mobilePreloadMethod:e.desktopPreloadMethod,p=new IntersectionObserver(function(e,t){e.forEach(function(e){"all-in-viewport"===h&&e.isIntersecting&&o(e.target.href,u,d),"nearby-mouse"===h&&(e.isIntersecting?f.add(e.target):f.delete(e.target))})});document.querySelectorAll("a[href^='"+window.location.origin+"']").forEach(function(t){var n=new RegExp(e.excludeKeywords.join("|"));e.excludeKeywords.length&&n.test(t.href)||p.observe(t)}),"nearby-mouse"===h&&document.addEventListener("mousemove",(c=function(t){[].concat(f).forEach(function(n){var r,i;r=n,i=t.pageY,Math.floor(Math.sqrt(Math.pow(t.pageX-(r.offsetLeft+r.offsetWidth/2),2)+Math.pow(i-(r.offsetTop+r.offsetHeight/2),2)))<e.mouseProximity&&(o(n.href,u,d),n.style.color="red")})},s=!1,function(){s||(c.apply(null,arguments),s=!0,setTimeout(function(){s=!1},500))}))}}});
